<div [formGroup]="stepsForm">
  <div formArrayName="steps">
  @for (step of steps.controls; track step; let i = $index) {
    @if (step.get('edit')?.value) {
    <div style="display: flex; align-items: center; margin-bottom: 8px;">
      <input
        #stepInput
        nz-input
        [formControl]="$any(step.get('step'))"
        style="flex: 1;"
        (blur)="onStepBlur(i)"
        (keydown)="onStepsKeyDown($event, i)"
      />
    </div>
    } @else {
    <div class="flex">
      <div style="flex: 1;">{{ step.get('step')?.value }}</div>
      <button nz-button nzType="link" (click)="editStep(i)" style="margin-left: 8px;">
        <nz-icon nzType="edit"></nz-icon>
      </button>
      <button nz-button nzType="link" (click)="removeStep(i)" style="margin-left: 8px;">
        <nz-icon nzType="delete"></nz-icon>
      </button>
    </div>
    }
  }
  </div>
  <button nz-button nzType="dashed" (click)="addStep()" style="width: 100%;">Add Step</button>
</div>